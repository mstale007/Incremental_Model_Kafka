# Incremental Model 
## Description
Developed a Microservice based architecture having 5 different components
1. Frontend (Simple HTML/CSS + JS website to test the architecture)
2. Backend (Flask, Kafka Producer)
3. Kafka Cosnsumer (Python script to consume new data and train and save model) 
4. Tensorflow Serving on Docker (Docker)
5. Saved Models (Folder having different saved versions of the model, used by Tensorflow serving to provide a API)

----------



## Steps



1. First, Host the frontend/index.html or Open it in a browser
```bash
https://<localhost/path-to-file>/index.html
```
2. Start the Flask backend (backend/predict_annotate.py) on a terminal
```console
python predict_annotate.py
```
3. Open a new terminal, Start our Incremental Model (Kafka consumer) (model/incremental_model.py)
```console
python incremental_model.py
```
4. Start Tensorflow serving on Docker
- Pull tensorflow serving image from dockerhub
```console
docker pull tensorflow/serving
```
- Run the docker image 
```console
docker run -it -v <path-to-model-folder>\model:/inc_model_kafka -p 8605:8605 --entrypoint /bin/bash tensorflow/serving
```
Here `inc_model_kafka` is just a sample name for the new folder that will be created in the docker container, you can use any other name

- After this you should entered in shell of the docker container, last step is to start the tensorflow server:

```console
tensorflow_model_server --port=8500 --rest_api_port=8605 --model_config_file=/inc_model_kafka/model.config
```

After everything is up and running you can start interacting with the frontend and as you go on add new data your new model will stored in `model/saved_model` directory


----------
## Architecture
All the components interact together in a way shown below:

![Flowchart](./readme_flowchart.png)

[Check Flowchart in High Resolution here](https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=Kafka_Mircoservice.drawio#R7V3pk9o4Fv9rqJpsFS7fho99MVdnt3c7mWTmS0qAAKdtyyMb6J6%2FfiVZPiWD3W1zpKErBOvwod97T%2B%2BSPDBu%2FOefMQhXH9EcegNdnT8PjNuBrmu2Y5D%2FaMlLUjI2zKRgid05b5QXPLr%2FQF6o8tK1O4dRqWGMkBe7YblwhoIAzuJSGcAYbcvNFsgrXzUESygUPM6AJ5Z%2Bcefxipdq9jiv%2BAW6yxW%2F9Eh3koopmD0tMVoH%2FHoBCmBS44P0NPwZoxWYo22hyLgbGDcYoTj55T%2FfQI8OazpiSb9JTW12yxgGcZMOk983n7%2Fcf%2Fn7%2Bz%2FOy%2FAv4wt%2B%2BGoPTcdOzrMB3poPBr%2Fd%2BCUdHfZ8kJ5GGxjXYBohbx3DKzzjQLLS7Ig82PUq9j1eEcUYPcEb5CHMzmaY%2BsicGKRmicHcJTef1rGxIx3ScVLJwRxEq%2BzKCxTE6SV1flw48fiO%2FtF78dxlQMo8uCAjc72BOHYJ1le8OEYhvUwIZm6wpOdS88NPtO52aNKzu55XvTX2LCmF0FsQQeC40IvC50IRB%2BVniHwY4xfShNeOOH1w1tHS421OiOO0bFWgQSstBJz4l9mpcyogPzghtCGKjGRzGoBzwjD8EOF4hZYoAN5dXnqdUwkdz7zNPWJjSgH8DuP4hSMI1jEqUwoZQvzylfdnB3%2FSA8VKD2%2Bfi5W3L%2FyonsJa4BWhNZ7BXYOiccaIAV7CeGdLLjXomO2kAAw9ELubshDqHs70zks8bnsxZ6ES0Pbfa5RWDCMG1RVpoBnhc15Jfi35%2F%2BwsU5yWPMYYAp90%2BDfc0vkAxGBAqanabusSSHTVA1PoRUza0y8M3ID%2Bv4JiD59POoi0sIFPWTiYRmHhLsjgJI%2BT3lx%2FYozLg1YSTH2FBJuRk0PcjQwj57%2Bb3F3fjbsRW5pWllumbSi6JYguzVQVVROll2aNFas3gjf2T2qC1JizjzhoC%2FYpwprTQypatJL8a0pejPofUOTGLpKifV9p4LvzOZO1e%2BljiuIY%2BTlN3LOpMKPBIs2xj4Q2tys3ho%2BkOy3ZEr0vP9s1P3uVSbogK0vNyIhTlmWKM2JOPUWisvujKHM%2FRZU4nWuqYMpq1fI4VSjMsehfnZAhZBfSc%2FjPS6p8K8tZqCsgDD2Cd0IX12TE41oI9rBIY2RUReRuS6KXpGg1ntz4FR%2BQy%2BYifrlhhQq0CrZosYjINFxFNrvvRmD%2F%2FX39R%2BhMv%2F2lLr1o9fnjN%2F3r96GI7AGUH1FVqVdrpNrFa7Uaq6lWkzDX8ZQYq2clhp9llg143tBQ2adY1OBqluxqE5xc5o5YjIKOU6PJPBJ1h1xLV1lnSHsmCpN4hhhGcapBqWCGqQyfxWssUah%2B%2BfTxnlzo5vFxoBNM1N8ef2BFqjtTkJx9ok1GnalRRlmN0lVxssvalBQopzfzT2vgE7ioT6epPtkVchqJk7YjoaYeick5Lc3JR1PXg9%2FmcOPOqMvxVcqT3RaXpsqTYacNu1afbMXpQ4OqcSA1MMCo2zRsTvKZ85cTxqDoRZUNuVE1UJ2RKFlHpsyO0HS9R%2BN0fBbS9dWuip0CbQ%2B57OenbJoUsZTx07g%2FH6nWAEYugFyfxR9qJ6ZsumFT2nUWU5ABLVdhQBQmcZGF%2B0xhvmaXvEpL1bSE%2FF7FMY2qXNHn1yfhNFLiresvlRm5A3KM0YLKR9Y6IgXOSLMNwxiNLcfRxpZFn3vyBP75%2FBtCE%2BV7uOwVZ8NUTEeA2tYU1RbBLhT3gPc%2BJ%2BohrAk1aZ3UJV1oZYCwD7xy9ZYPDK036dV4pUfMUIiHmc4r6U%2BwiYcukRcB768Wrs0qYwyCaEF6pf1p1Is32CI8L59erd76Aviu95JUZt5cMjAGVbZX0NtASuJCTfkeuOC5Ys%2B0iLPKPCQ35KNPm%2BDl9CfdHLELUmtHN8f5b0v9IFpqv4PFE3Vepy7tGtsoN6tqQTxLoCpjp1lGNl6V3x%2FOENwUN%2FL4wQW5U0aOd5%2B7UegBfnNu4LmF4Vh4CMTFYdrj4tkvbHWZ6%2BaKDDjzq6SSYaDTq%2F%2BFiK4FQ4j3iAhSnFDbTl%2BPoEPQQa0xJ%2FvVtJ7zSdWy1OyjlZRq%2Bfw8cpSR5Wimzr8lc7XZn2Imc9U34fa3kv8hREYdd%2FUpTw7LelKvacpxDxjN17P2rNYRT7V3x%2BiWounj%2FDMqm6Q1MVN1nBnrJedAbzxjNjBm%2BrbXHXuklH0WWR5KYWwywVH2hZr92evpqHceeEjT6P6AOCJ2IE2D%2BOkRbCB177O6D0dwyJ93gha9mwdARWnAbokoEQNZbK3pdGk25%2Fjj0miD8HQN%2F7Z88NZsbWpVrhaZWjZelqo4auFj9jd4Mste9OTURKL2hbYqDjvTHFuscevoReYkqvEAVf1waB3TqfomS5lVB6JLfAOJbavoc4WmzLJuTSkkI7lWrCFD2iCTYG%2FYio7ojSagy%2FWBApR7I0RZLAlDIucLwYqQ%2BuHZc1jXA%2BuWnmsdoygXxHuphBf1AASvLfOjUcNoBdRk8Ue9N2XEkEX6T1SYjS1FLw6eOHZHlm1NQrkX2VZHgact28TI6hTSfNsfSro1h6K5PJMh1aM8G52sPNOsBtqZJTFFDyjBmoRLLxKsjuZOWoKZomkdMg8PG9QfS441ByTN4NBa62myzJ7%2B5JrZQLfo22mU5Yan4ss0pR413ZLlefTpUWtgkb%2BzLA%2BzedbUcaGT%2BQO6zDSuDUMIkbs8MFb53XHk7oyjnceMK37iC9Y%2BFtem7Qr21aQJXHA%2FHO4XpjxhcLpgyqCw8vTCjKeN94UZTxicLpgRsMVKEdjQPsmqJMKfBIgLa544%2BhfWPGFwumBNttsCSzbgWyscIE1NMCN7sB2lQS7NsrKUmqJxqUmNy%2F5WQ5myhTFdZEh1lndeoUM1o7zCrwoDnyfvdSJ73sjArZLfblAQrf29yW%2BXVPSjo3vJNj9hcLqYO6up4D%2FW1OlkU%2BVLWiDzqafrKw%2BT1m29PkW15bi0X2lqCQMm1TYsUxwwuz9Vo0HY%2BZ1FIKxXpXMeGLYG6%2BWjJxjPVjyUKY0kV0aR%2FE3oTdSl9FbQtuwb9coZ1ERBSwH2ruLhxTX%2BEopId9%2BhlxTWurJgLsR3G5jEdLWBGEoH28hUIrCEPniC%2BFti8vRCObx2XEms0HTJFgCGLMu%2Ft1SKlGjfsLNRmfJ%2BuD0e06jt%2Ft2Q0vDjqezxaJsnhG0O55%2FFuuNimyLWYKcr7cSwbZAC1XeihVlJtMjEVGk3Dak3RVN7myztBqnC70zHyYil%2BV4akompBspxf3OTTO05KcfY2fiqj7FG9BB%2BMLovCsy3zWvn%2Fjqam%2BKCeDPfWA2czcNNF0DPJxZVw%2FZN9ud8Ze7dxAPRU1FGJMUPGIYYzWAU0TEhKl88UxoImMMsN3%2FzBJ%2F686yKLaqLSf4H9ubZTZxTp797lu9ipPhw7q59vn%2BWDwjxTUaU5yfav%2F5r3X1%2B0kdfZ4Z7c4s%2BPj7hufZtq4RBm12z2mt0miQ1XBfhTR1b3cObBlCPup%2FAuGKxjEWqzzihOCz9vVfDbuDDfmfmSkYp7VbY66pSXAuhGgeFcV8Qv1XUb8cWbxdV5fiqipDzDYMIYdKMZpk%2BQrxJFIefbhGxTvCHFlrCRcF9P1TTjRL7C2K7u0d8kxgWxIj2qKsnse1YCymfzt7VhamapmT7ibFvcdsxje5GVvzI9h2zlMLGZOS7r0nCaqACnYGGuw4Jac%2BVrfvkUj0XKAgTcTehxyE9Jr%2BJ4uuz7Ysm8WrtT6niS%2F%2FRr0RYToiwvEdLpEQb2ldjbDkU61rqxe2JStMVvfQxyiTmKFqZxgQSM0eKKgkH92coOSLVHC2uMyRKl24MyoG7kT3YHd5hRw8QE%2FphWuIhYz5pfOD8Yj6OuH70KghQDM55aXTrILpZeZ2BIXk54mEXPTtixOkBE0F41kvWW%2BNiV6OB9tFxkTmUElVnpb1WC9Mr%2B8CqCzArd%2FgEVsgHoqb2azDD0CcDzBTfewhwkNgJn7mjkfsjqZYp7CubLJopGhr7NLziI74TEtTT9yhk%2BqHE6SXbuMrqjwYbxOkvWzX2%2BS5dYjgJZoNEMtmyHW06CG1LXydnvVmBe4vOlh0k6prTfaJVk%2FfQNdC%2FnDeqW7xr5TU4jlrecdeobhuR6JC8V470FcbgpdCMS77W15k0bJ%2B%2BpykntOQOcrLr4MWGYoqFhwgvr6hXwbiim3yfx%2BxRkVWjG%2FqX0aMkciBQZL2FaIyrudyGI0qQcU%2B6jRQ2UbMpwaZeYNMto6wMGJLstINiJmoCRczG6lhnTkbmMi1U6NroTHYn7RFMQy0bF7Yqe3uaNjoknprozZszh39iKIxUW5zm3xtuY71irEsE52FB0wXQBJAKUejGIec2gzKqvIXOlmywKCXlLsKX8lE5j5ejdxeE3kPUO0hn98Zkh0Wt%2Fq0ml5jzjx49%2FM9iwTukO439D0aQ8MvqEm6%2BEExv4eZf%2FRAjtnNPaRufUwk7dynXUzui%2BgoaGvJSi0FB3bYlgWdp8mT3kWb5I73iRaSFsZR79LqIRIshZnkUelCNOc%2Fmgam4RPdaUNbEPLMy2dFtQstprHm6jghLRNGQqBLufBiv4HAGQjcmrB7R5nRB3ORusSBPMXv5hrm8JJxKaGDEI81vUoZfQ19V8mJJDYXXQzV7SXQXHmz53dsC5RzSV0nMPCIZiysHFZrZ94rwch2w%2FXg3i3HonSp302WlB4g6y%2B%2FTOSr%2BTNiWCEBVTGPf8tFaAthhPRyQIHa%2FBHw%2FRSRLko9GEaNjS4QSOewhhSLq1gmi3jwdpW4eaRcOaRvFsIxyQpSp7Y5iZCawvH3bKAY5xIhqoHlzundDYvMYd%2F8H)


## ML in practice
The online machine learning paradigm is a bit different from the traditional/conventional way of training machine learning models.
- In traditional approaches the dataset is fixed and the model iterates over it n number of times. 
- In online learning, the model continues to incrementally learn/update it's parameters as soon as the new data points are available and this process is expected to continue indefinitely. 

## References

- [Python Kafka Library](https://kafka-python.readthedocs.io/en/master/usage.html)
- [Tensorflow Online Learning](https://www.tensorflow.org/io/tutorials/kafka#online_learning)
- [Using Docker for Serving Tensorflow](https://www.youtube.com/watch?v=P-5sMcpTE0g)
